fragment FullMessage on ModernMessage {
  __typename
  date
  fallback
  id
  message
  sender {
    __typename
    ...UserShort
  }
  senderBadge {
    __typename
    ...UserBadge
  }
  source {
    __typename
    ... on MessageSourceChat {
      chat {
        __typename
        ... on PrivateRoom {
          id
        }
        ... on SharedRoom {
          id
          isChannel
          membersCount
        }
      }
    }
  }
  spans {
    __typename
    ...SpanFragment
  }
  ... on GeneralMessage {
    attachments {
      __typename
      fallback
      ... on MessageAttachmentFile {
        fileId
        fileMetadata {
          __typename
          imageFormat
          imageHeight
          imageWidth
          isImage
          mimeType
          name
          size
        }
        filePreview
        id
      }
      ... on MessageRichAttachment {
        fallback
        icon {
          __typename
          metadata {
            __typename
            imageFormat
            imageHeight
            imageWidth
            isImage
            mimeType
            name
            size
          }
          url
        }
        id
        image {
          __typename
          metadata {
            __typename
            imageFormat
            imageHeight
            imageWidth
            isImage
            mimeType
            name
            size
          }
          url
        }
        imageFallback {
          __typename
          photo
          text
        }
        keyboard {
          __typename
          buttons {
            __typename
            id
            style
            title
            url
          }
        }
        socialImage {
          __typename
          metadata {
            __typename
            imageFormat
            imageHeight
            imageWidth
            isImage
            mimeType
            name
            size
          }
          url
        }
        subTitle
        text
        title
        titleLink
        titleLinkHostname
      }
    }
    commentsCount
    edited
    id
    overrideAvatar {
      __typename
      crop {
        __typename
        h
        w
        x
        y
      }
      uuid
    }
    overrideName
    quotedMessages {
      __typename
      ...QuotedMessage
    }
    reactions {
      __typename
      reaction
      user {
        __typename
        ...UserShort
      }
    }
  }
  ... on StickerMessage {
    commentsCount
    date
    id
    overrideAvatar {
      __typename
      crop {
        __typename
        h
        w
        x
        y
      }
      uuid
    }
    overrideName
    quotedMessages {
      __typename
      ...QuotedMessage
    }
    reactions {
      __typename
      reaction
      user {
        __typename
        ...UserShort
      }
    }
    sender {
      __typename
      ...UserShort
    }
    senderBadge {
      __typename
      ...UserBadge
    }
    sticker {
      __typename
      ...StickerFragment
    }
  }
  ... on ServiceMessage {
    id
    overrideAvatar {
      __typename
      crop {
        __typename
        h
        w
        x
        y
      }
      uuid
    }
    overrideName
    serviceMetadata {
      __typename
      ... on InviteServiceMetadata {
        invitedBy {
          __typename
          ...UserTiny
        }
        users {
          __typename
          ...UserTiny
        }
      }
      ... on KickServiceMetadata {
        kickedBy {
          __typename
          ...UserTiny
        }
        user {
          __typename
          ...UserTiny
        }
      }
      ... on TitleChangeServiceMetadata {
        title
      }
      ... on PhotoChangeServiceMetadata {
        photo
      }
      ... on PostRespondServiceMetadata {
        respondType
      }
    }
  }
}