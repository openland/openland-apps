fragment VoiceChatParticipant on VoiceChatParticipant {
    id
    user {
        id
        photo
        firstName
        name
    }
}

fragment VoiceChatSpeaker on VoiceChatParticipant {
    ...VoiceChatParticipant
    status
}

fragment VoiceChatListener on VoiceChatParticipant {
    ...VoiceChatParticipant
    handRaised
}

fragment VoiceChatMe on VoiceChatParticipant {
    id
    user {
        id
        photo
        firstName
        name
        shortname
    }
    status
    handRaised
}

fragment VoiceChatEntity on VoiceChat {
    id
    title
    active
    adminsCount
    speakersCount
    listenersCount
    handRaisedCount
    parentRoom {
        id
        title
        photo
        membership
        kind
        isChannel
        shortname
        organization {
            id
            isAdmin: betaIsAdmin
            membersCanInvite: betaMembersCanInvite
        }
        isPremium
        role
    }
    pinnedMessage {
        id
        message
        spans {
            ...MessageSpan
        }
    }
    me {
        ...VoiceChatMe
    }
}

fragment VoiceChatShort on VoiceChat {
    id
    active
    title
    speakersCount
    listenersCount
    parentRoom {
        id
        title
        photo
    }
    speakers {
        ...VoiceChatParticipant
    }
}

fragment VoiceChatWithSpeakers on VoiceChat {
    ...VoiceChatEntity
    speakers {
        ...VoiceChatSpeaker
    }
}

fragment FullVoiceChat on VoiceChat {
    ...VoiceChatEntity
    speakers {
        ...VoiceChatSpeaker
    }
    listeners {
        ...VoiceChatListener
    }
}

query VoiceChat($id: ID!) {
    voiceChat(id: $id) {
        ...VoiceChatWithSpeakers
    }
}

query VoiceChatFull($id: ID!) {
    voiceChat(id: $id) {
        ...VoiceChatWithSpeakers
    }
    voiceChatListeners(id: $id, first: 12) {
        items {
            ...VoiceChatListener
        }
        cursor
    }
}

query VoiceChatListeners($id: ID!, $first: Int!, $after: String) {
    voiceChatListeners(id: $id, first: $first, after: $after) {
        items {
            ...VoiceChatListener
        }
        cursor
        haveMore
    }
}

query ActiveVoiceChats($first: Int!, $after: String) {
    activeVoiceChats(first: $first, after: $after) {
        cursor
        items {
            ...VoiceChatShort
        }
    }
}

query VoiceChatUser($uid: ID!) {
    user(id: $uid) {
        id
        name
        photo
        followersCount
        followedByMe
        about
    }
    conversation: room(id: $uid) {
        ... on PrivateRoom {
            id
            settings {
                id
                mute
            }
        }
    }
}

query VoiceChatHandRaised($id: ID!, $first: Int!, $after: String) {
    voiceChatHandRaised(id: $id, first: $first, after: $after) {
        items {
            id
            user {
                id
                photo
                firstName
                name
                followersCount
            }
        }
        cursor
        haveMore
    }
}

query VoiceChatControls($id: ID!) {
    voiceChat(id: $id) {
        id
        me {
            id
            user {
                id
                shortname
            }
            status
            handRaised
        }
    }
}

mutation VoiceChatCreate($input: VoiceChatInput!) {
    voiceChatCreate(input: $input) {
        ...VoiceChatWithSpeakers
    }
}

mutation VoiceChatCreateInChat($input: VoiceChatInput!, $cid: ID!) {
    voiceChatCreateInChat(input: $input, cid: $cid) {
        chat {
            ...VoiceChatWithSpeakers
        }
        peerId
        conference {
            ...ConferenceShort
        }
    }
}

mutation VoiceChatJoin($id: ID!) {
    voiceChatJoin(id: $id) {
        id
    }
}

mutation VoiceChatUpdate($id: ID!, $input: VoiceChatInput!) {
    voiceChatUpdate(id: $id, input: $input) {
        id
    }
}

mutation VoiceChatEnd($id: ID!) {
    voiceChatEnd(id: $id) {
        id
    }
}

mutation VoiceChatLeave($id: ID!) {
    voiceChatLeave(id: $id)
}

mutation VoiceChatUpdateAdmin($id: ID!, $uid: ID!, $admin: Boolean!) {
    voiceChatUpdateAdmin(id: $id, uid: $uid, admin: $admin)
}

mutation VoiceChatKick($id: ID!, $uid: ID!) {
    voiceChatKick(id: $id, uid: $uid)
}

mutation VoiceChatPromote($id: ID!, $uid: ID!) {
    voiceChatPromote(id: $id, uid: $uid)
}

mutation VoiceChatDemote($id: ID!, $uid: ID!) {
    voiceChatDemote(id: $id, uid: $uid)
}

mutation VoiceChatRaiseHand($id: ID!, $raised: Boolean!) {
    voiceChatRaiseHand(id: $id, raised: $raised)
}

mutation VoiceChatSetPinnedMessage($id: ID!, $message: String, $spans: [MessageSpanInput!]) {
    voiceChatSetPinnedMessage(id: $id, message: $message, spans: $spans) {
        id
    }
}

mutation VoiceChatDeletePinnedMessage($id: ID!) {
    voiceChatDeletePinnedMessage(id: $id) {
        id
    }
}

query VoiceChatEventsState($id: ID!) {
    voiceChatEventsState(id: $id) {
        state
    }
}

query VoiceChatPrefetch($id: ID!) {
    voiceChatEventsState(id: $id) {
        state
    }
    voiceChat(id: $id) {
        ...VoiceChatWithSpeakers
    }
    voiceChatListeners(id: $id, first: 12) {
        items {
            ...VoiceChatListener
        }
        cursor
        haveMore
    }
}

subscription VoiceChatEvents($id: ID!, $fromState: String!) {
    voiceChatEvents(fromState: $fromState, id: $id) {
        state
        events {
            ... on VoiceChatParticipantUpdatedEvent {
                chat {
                    id
                    handRaisedCount
                    me {
                        ...VoiceChatMe
                    }
                }
                participant {
                    ...VoiceChatParticipant
                    status
                    handRaised
                }
            }
            ... on VoiceChatUpdatedEvent {
                chat {
                    ...VoiceChatEntity
                }
            }
        }
    }
}

subscription ActiveVoiceChatsEvents {
    activeVoiceChatsEvents {
        ... on VoiceChatUpdatedEvent {
            chat {
                ...VoiceChatShort
            }
        }
    }
}
