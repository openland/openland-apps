query MyCards {
    myCards {
        id
        pmid
        last4
        brand
        expYear
        expMonth
        isDefault
        deleted
    }
}
mutation CreateCardSetupIntent($retryKey: String!) {
    cardCreateSetupIntent(retryKey: $retryKey) {
        id
        clientSecret
    }
}
mutation CommitCardSetupIntent($id: ID!, $pmid: ID!) {
    cardCommitSetupIntent(id: $id, pmid: $pmid) {
        id
    }
}
mutation RemoveCard($id: ID!) {
    cardRemove(id: $id) {
        id
        deleted
    }
}
mutation MakeCardDefault($id: ID!) {
    cardMakeDefault(id: $id) {
        id
        isDefault
    }
}
mutation CreateDepositIntent($cardId: ID!, $amount: Int!, $retryKey: String!) {
    cardDepositIntent(id: $cardId, amount: $amount, retryKey: $retryKey) {
        id
        clientSecret
    }
}
mutation PaymentIntentCommit($id: ID!) {
    paymentIntentCommit(id: $id)
}
mutation PaymentIntentCancel($id: ID!) {
    paymentCancel(id: $id)
}
mutation Donate($id: ID!) {
    donateToUser(id: $id, amount: 100)
}
fragment WalletTransactionFragment on WalletTransaction {
    id
    status
    date
    operation {
        ... on WalletTransactionDeposit {
            amount
            payment {
                id
                status
                card {
                    id
                    brand
                    last4
                }
                intent {
                    id
                    clientSecret
                }
            }
        }
        ... on WalletTransactionIncome {
            amount
            payment {
                id
                status
                card {
                    id
                    brand
                    last4
                }
                intent {
                    id
                    clientSecret
                }
            }
            source {
                ... on WalletSubscription {
                    id
                    product {
                        ... on WalletProductGroup {
                            group {
                                id
                                title
                                photo
                            }
                        }

                        ...on WalletProductDonation {
                            user {
                                id
                                name
                                photo
                            }
                        }
                    }
                }
                ... on Purchase {
                    id
                    product {
                        ... on WalletProductGroup {
                            group {
                                id
                                title
                                photo
                            }
                        }

                        ...on WalletProductDonation {
                            user {
                                id
                                name
                                photo
                            }
                        }
                    }
                }
            }
        }
        ... on WalletTransactionTransferIn {
            amount
            payment {
                id
                status
                card {
                    id
                    brand
                    last4
                }
                intent {
                    id
                    clientSecret
                }
            }
            fromUser {
                ...UserShort
            }
        }
        ... on WalletTransactionTransferOut {
            amount
            walletAmount
            chargeAmount
            payment {
                id
                status
                card {
                    id
                    brand
                    last4
                }
                intent {
                    id
                    clientSecret
                }
            }
            toUser {
                ...UserShort
            }
        }
        ... on WalletTransactionSubscription {
            amount
            walletAmount
            chargeAmount
            subscription {
                id
                interval
                amount
                product {
                    ... on WalletProductGroup {
                        group {
                            id
                            title
                            photo
                        }
                    }

                    ...on WalletProductDonation {
                        user {
                            id
                            name
                            photo
                        }
                    }
                }
            }
            payment {
                id
                status
                intent {
                    id
                    clientSecret
                }
                card {
                    id
                    brand
                    last4
                }
            }
        }
        ... on WalletTransactionPurchase {
            amount
            walletAmount
            chargeAmount
            purchase {
                id
                product {
                    ... on WalletProductGroup {
                        group {
                            id
                            title
                            photo
                        }
                    }

                    ...on WalletProductDonation {
                        user {
                            id
                            name
                            photo
                        }
                    }
                }
            }
            payment {
                id
                status
                intent {
                    id
                    clientSecret
                }
                card {
                    id
                    brand
                    last4
                }
            }
        }
        
    }
}
query MyWallet {
    myWallet {
        id
        balance
        state
        isLocked
        failingPaymentsCount
    }
    transactionsPending {
        ...WalletTransactionFragment
    }
    transactionsHistory(first: 20) {
        items {
            ...WalletTransactionFragment
        }
        cursor
    }
}

query TransactionsHistory($first: Int!, $after: String) {
    transactionsHistory(first: $first, after: $after) {
        items {
            ...WalletTransactionFragment
        }
        cursor
    }
}

fragment WalletUpdateFragment on WalletUpdate {
    ... on WalletUpdateBalance {
        amount
    }
    ... on WalletUpdateLocked {
        isLocked
        failingPaymentsCount
    }
    ... on WalletUpdateTransactionSuccess {
        transaction {
            ...WalletTransactionFragment
        }
    }
    ... on WalletUpdateTransactionCanceled {
        transaction {
            ...WalletTransactionFragment
        }
    }
    ... on WalletUpdateTransactionPending {
        transaction {
            ...WalletTransactionFragment
        }
    }
    ... on WalletUpdatePaymentStatus {
        payment {
            id
            status
            intent {
                id
                clientSecret
            }
            card {
                id
                brand
                last4
            }
        }
    }
}
subscription WalletUpdates($state: String!) {
    event: walletUpdates(fromState: $state) {
        ... on WalletUpdateSingle {
            state
            update {
                ...WalletUpdateFragment
            }
        }
        ... on WalletUpdateBatch {
            state
            updates {
                ...WalletUpdateFragment
            }
        }
    }
}
query Subscriptions {
    subscriptions {
        id
        state
        expires
        amount
        interval
        product {
            ... on WalletProductGroup {
                group {
                    id
                    title
                    photo
                }
            }
        }
    }
}
mutation CancelSubscription($id: ID!) {
    subscriptionCancel(id: $id) {
        id
    }
}
query StripeToken {
    stripeToken
}
