fragment ConferenceFull on Conference {
    id
    startTime
    peers {
        id
        user {
            ...UserShort
        }
        connection {
            state
            sdp
            ice
        }
    }
    iceServers {
        urls
        username
        credential
    }
}
fragment ConferenceShort on Conference {
    id
    startTime
    iceServers {
        urls
        username
        credential
    }
}

fragment MediaStreamFull on MediaStream{
    id
    peerId
    state
    seq
    sdp
    ice
    settings{
        videoIn
        videoOut
        videoOutSource
        audioIn
        audioOut
        iceTransportPolicy
    }
    mediaState {
        videoOut
        videoSource
        audioOut
    }
}

query Conference($id: ID!) {
    conference(id: $id) {
        ...ConferenceFull
    }
}

query ConferenceMedia($id: ID!, $peerId: ID!) {
    conferenceMedia(id: $id, peerId: $peerId) {
        id
        streams{
            ...MediaStreamFull
        }
        iceServers {
            urls
            username
            credential
        }
    }
}
mutation ConferenceJoin($id: ID!) {
    conferenceJoin(id: $id) {
        peerId
        conference {
            ...ConferenceShort
        }
    }
}

mutation conferenceAddScreenShare($id: ID!){
    conferenceAddScreenShare(id: $id) {
        ...ConferenceShort
    }
}
mutation conferenceRemoveScreenShare($id: ID!){
    conferenceRemoveScreenShare(id: $id) {
        ...ConferenceShort
    }
}
mutation conferenceAlterMediaState($id: ID!, $settings: MediaStreamMediaStateInput!){
    conferenceAlterMediaState(id: $id, settings: $settings) {
        ...ConferenceShort
    }
}

mutation ConferenceLeave($id: ID!, $peerId: ID!) {
    conferenceLeave(id: $id, peerId: $peerId) {
        ...ConferenceShort
    }
}
mutation ConferenceKeepAlive($id: ID!, $peerId: ID!) {
    conferenceKeepAlive(id: $id, peerId: $peerId) {
        ...ConferenceShort
    }
}
mutation ConferenceOffer($id: ID!, $ownPeerId: ID!, $peerId: ID!, $offer: String!) {
    peerConnectionOffer(id: $id, peerId: $peerId, ownPeerId: $ownPeerId, offer: $offer) {
        ...ConferenceShort
    }
}
mutation ConferenceAnswer($id: ID!, $ownPeerId: ID!, $peerId: ID!, $answer: String!) {
    peerConnectionAnswer(id: $id, peerId: $peerId, ownPeerId: $ownPeerId, answer: $answer) {
        ...ConferenceShort
    }
}
mutation ConferenceCandidate($id: ID!, $ownPeerId: ID!, $peerId: ID!, $candidate: String!) {
    peerConnectionCandidate(
        id: $id
        peerId: $peerId
        ownPeerId: $ownPeerId
        candidate: $candidate
    ) {
        ...ConferenceShort
    }
}
mutation MediaOffer($id: ID!, $peerId: ID!, $offer: String!, $seq: Int!) {
    mediaStreamOffer(id: $id, peerId: $peerId, offer: $offer, seq: $seq) {
        id
        streams{
            ...MediaStreamFull
        }
    }
}
mutation MediaNegotiationNeeded($id: ID!, $peerId: ID!, $seq: Int!) {
    mediaStreamNegotiationNeeded(id: $id, peerId: $peerId, seq: $seq) {
        id
        streams{
            ...MediaStreamFull
        }
    }
}
mutation MediaFailed($id: ID!, $peerId: ID!) {
    mediaStreamFailed(id: $id, peerId: $peerId) {
        id
        streams{
            ...MediaStreamFull
        }
    }
}
mutation MediaAnswer($id: ID!, $peerId: ID!, $answer: String!, $seq: Int!) {
    mediaStreamAnswer(id: $id, peerId: $peerId, answer: $answer, seq: $seq) {
        id
        streams{
            ...MediaStreamFull
        }
    }
}
mutation MediaCandidate($id: ID!, $peerId: ID!, $candidate: String!) {
    mediaStreamCandidate(id: $id, peerId: $peerId, candidate: $candidate) {
        id
        streams{
            ...MediaStreamFull
        }
    }
}
subscription ConferenceMediaWatch($id: ID!, $peerId: ID!) {
    media: alphaConferenceMediaWatch(id: $id, peerId: $peerId) {
        id
        streams{
            ...MediaStreamFull
        }
    }
}
subscription ConferenceWatch($id: ID!) {
    alphaConferenceWatch(id: $id) {
        ...ConferenceFull
    }
}
