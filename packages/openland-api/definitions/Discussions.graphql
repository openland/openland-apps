#
# Hubs
#

fragment HubSimple on Hub {
    id
    title
    shortname
    type
    owner {
        id
        firstName
        lastName
    }
}

query Hubs {
    hubs {
        ...HubSimple
    }
}

query Hub($id: ID!) {
    hub(id: $id) {
       ...HubSimple
    }
}

#
# Discussions
#


fragment ParagraphSimple on Paragraph {
    ... on TextParagraph {
        text
        spans {
            ...SpanFragment
        }
    }
    ... on ImageParagraph {
        url
        image {
            uuid
        }
        fileMetadata {
            isImage
            imageWidth
            imageHeight
            imageFormat
        }
    }
    ... on H1Paragraph {
        text
    }
    ... on H2Paragraph {
        text
    }
}

fragment DiscussionDraftSimple on DiscussionDraft {
    id
    title
    content {
       ...ParagraphSimple
    }
    publishedCopy {
        id
    }
    hub {
        id
        title
        shortname
    }
    createdAt
    updatedAt
    deletedAt
}

fragment DiscussionSimple on Discussion {
    id
    title
    content {
       ...ParagraphSimple
    }
    hub {
        id
        title
        shortname
    }
    author {
        id
        name
    }

    draft {
        id
    }
    canEdit

    createdAt
    updatedAt
    deletedAt
}

query Discussions($hubs: [ID!]!, $after: String) {
    discussions(hubs: $hubs, first: 20, after: $after) {
        items {
            ...DiscussionSimple
        }
        cursor   
    }
}

query DiscussionDrafts($after: String) {
    discussionMyDrafts(first: 20, after: $after) {
        items {
            ...DiscussionDraftSimple
        }
        cursor   
    }
}

query DiscussionDraft($id: ID!) {
    discussionDraft(id: $id) {
        ...DiscussionDraftSimple
    }
}

mutation DiscussionCreateDraft {
    discussionCreate(input: {  }) {
        ...DiscussionDraftSimple
    }
}

mutation DiscussionUpdate($id: ID!, $hub: ID, $title: String!, $content: [DiscussionContentInput!]) {
    discussionUpdate(id: $id, input: { hub: $hub, title: $title, content: $content }) {
        ...DiscussionDraftSimple
    }
}

mutation DiscussionPublish($id: ID!) {
    discussionDraftPublish(draftId: $id) {
        ...DiscussionSimple
    }
}